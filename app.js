webpackJsonp([0],{0:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var r=n(1),o=_interopRequireDefault(r),a=n(3),i=_interopRequireDefault(a);o.default.bootstrap(window.document,[i.default],{strictDi:!0})},3:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=_interopRequireDefault(r),a=n(4),i=_interopRequireDefault(a),s=n(5),l=_interopRequireDefault(s),u=n(7),c=_interopRequireDefault(u),f=n(9),p=_interopRequireDefault(f),d=n(10),h=_interopRequireDefault(d),g=n(12),m=_interopRequireDefault(g),_=n(114),v=_interopRequireDefault(_);t.default=o.default.module("multichat",[i.default,l.default,c.default,m.default]).config(p.default).config(h.default).controller("ChatController",v.default).name},9:function(e,t){"use strict";function production(e,t){t.debugInfoEnabled(!1)}production.$inject=["$locationProvider","$compileProvider"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=production},10:function(e,t,n){"use strict";function routes(e,t){function css(e){return"/themes/"+(e.theme||"default")+"/style.css"}css.$inject=["$stateParams"];var r={name:"chat",url:"/chat?username?goodgame?peka2tv?twitch?theme?platforms",reloadOnSearch:!1,controller:"ChatController",controllerAs:"vm",templateUrl:function(e){return"/themes/"+(e.theme||"default")+"/"},css:css},o={name:"help",url:"/help",template:n(11)};e.state(r),e.state(o),t.otherwise("/help")}routes.$inject=["$stateProvider","$urlRouterProvider"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=routes},11:function(e,t){e.exports="<div>\r\n    Страница помощи (в разработке)\r\n</div>"},12:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=_interopRequireDefault(r),a=n(13),i=_interopRequireDefault(a),s=n(65),l=_interopRequireDefault(s),u=n(66),c=_interopRequireDefault(u),f=n(79),p=_interopRequireDefault(f),d=n(80),h=_interopRequireDefault(d),g=n(81),m=_interopRequireDefault(g),_=n(82),v=_interopRequireDefault(_);t.default=o.default.module("multichat.shared",[]).service("peka2tvMessageHandler",i.default).service("goodgameMessageHandler",l.default).factory("goodgameSmiles",p.default).service("twitchMessageHandler",c.default).service("livecodingMessageHandler",v.default).service("platforms",h.default).service("messages",m.default).name},13:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=n(14),a=_interopRequireDefault(o),i=n(64),s=_interopRequireDefault(i),l=function(e){function Peka2tvMessageHandler(e,t){_classCallCheck(this,Peka2tvMessageHandler);var n=_possibleConstructorReturn(this,(Peka2tvMessageHandler.__proto__||Object.getPrototypeOf(Peka2tvMessageHandler)).call(this));return n.$http=t,n.$rootScope=e,n}return Peka2tvMessageHandler.$inject=["$rootScope","$http"],_inherits(Peka2tvMessageHandler,e),r(Peka2tvMessageHandler,[{key:"connect",value:function(e){var t=this;this.ioSocket=a.default.connect("wss://chat.funstream.tv",{transports:["websocket"],path:"/",reconnection:!0,reconnectionDelay:500,reconnectionDelayMax:2e3,reconnectionAttempts:5}),this.ioSocket.on("connect",function(){t.$http.post("https://funstream.tv/api/user",{name:e}).then(function(e){t.ioSocket.emit("/chat/join",{channel:"stream/"+e.data.id}),t.ioSocket.on("/chat/message",function(e){var n=t.process(e.text),r=e.to?"@"+e.to.name+",":"",o=e.from.name+":";t.callback&&(t.callback({platform:"peka2tv",text:o+" "+r+" "+n}),t.$rootScope.$apply())})})})}},{key:"process",value:function(e){return e.replace(/:(\w+|\d+):/g,function(e,t){return"<img src='https://funstream.tv/build/images/smiles/"+t+".png' />"})}}]),Peka2tvMessageHandler}(s.default);t.default=l},64:function(e,t){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),r=function(){function BaseMessageHandler(){_classCallCheck(this,BaseMessageHandler),this.callback=null}return n(BaseMessageHandler,[{key:"connect",value:function(e){}},{key:"process",value:function(e){}}]),BaseMessageHandler}();t.default=r},65:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=n(64),a=_interopRequireDefault(o),i=function(e){function GoodgameMessageHandler(e,t,n){_classCallCheck(this,GoodgameMessageHandler);var r=_possibleConstructorReturn(this,(GoodgameMessageHandler.__proto__||Object.getPrototypeOf(GoodgameMessageHandler)).call(this));return r.$http=t,r.goodgameSmiles=n,r.$rootScope=e,r}return GoodgameMessageHandler.$inject=["$rootScope","$http","goodgameSmiles"],_inherits(GoodgameMessageHandler,e),r(GoodgameMessageHandler,[{key:"connect",value:function(e){var t=this;this.socket=new WebSocket("ws://chat.goodgame.ru:8081/chat/websocket"),this.socket.onopen=function(){t.$http.get("https://goodgame.ru/api/getchannelstatus?&fmt=json&id="+e).then(function(e){for(var n in e.data){var r={type:"join",data:{channel_id:n,hidden:!1}};t.socket.send(JSON.stringify(r))}})},this.socket.onmessage=function(e){var n=JSON.parse(e.data);switch(n.type){case"message":var r=t.process(n.data.text);t.callback&&t.callback({platform:"goodgame",text:n.data.user_name+": "+r}),t.$rootScope.$apply()}}}},{key:"process",value:function(e){var t=this;return e.replace(/:(\w+|\d+):/g,function(e,n){var r=t.goodgameSmiles.find(function(e){return e.name===n});return r?'<img class="smile" src=\''+r.img+"' />":":"+n+":"})}}]),GoodgameMessageHandler}(a.default);t.default=i},66:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=n(67),a=_interopRequireDefault(o),i=n(64),s=_interopRequireDefault(i),l=function(e){function TwitchMessageHandler(e){_classCallCheck(this,TwitchMessageHandler);var t=_possibleConstructorReturn(this,(TwitchMessageHandler.__proto__||Object.getPrototypeOf(TwitchMessageHandler)).call(this)),n={connection:{secure:!0,reconnect:!0}};return t.tmi=new a.default.client(n),t.tmi.on("message",function(n,r,o,a){t.callback&&(t.callback({platform:"twitch",text:t.process(o,r)}),e.$apply())}),t}return TwitchMessageHandler.$inject=["$rootScope"],_inherits(TwitchMessageHandler,e),r(TwitchMessageHandler,[{key:"connect",value:function(e){this.tmi.opts.channels=[e].map(function(e){return"#"+e}),this.tmi.connect()}},{key:"process",value:function(e,t){return t["display-name"]+": "+e}}]),TwitchMessageHandler}(s.default);t.default=l},79:function(e,t){"use strict";function GoodgameSmiles(){var e=Global.Smiles,t=[].concat.apply([],Object.keys(Global.Channel_Smiles).map(function(e){return Global.Channel_Smiles[e]}));return[].concat(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=GoodgameSmiles},80:function(e,t){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),r=function(){function Platforms(e){_classCallCheck(this,Platforms),this.$location=e,this.platforms=["twitch","peka2tv","goodgame","livecoding"]}return Platforms.$inject=["$location"],n(Platforms,[{key:"getPlatforms",value:function(){var e=this,t=this.$location.search();return t.platforms&&!Array.isArray(t.platforms)?t.platforms.split(",").filter(function(t){return e.platforms.indexOf(t)>=0}):t.platforms||this.platforms}}]),Platforms}();t.default=r},81:function(e,t){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),r=function(){function Messages(e,t,n){var r=this;_classCallCheck(this,Messages),this.messages=[];for(var o=n.getPlatforms(),a=0;a<o.length;a++){var i=o[a],s=t[i]||t.username;if(s){var l=e.get(i+"MessageHandler");l.callback=function(e){r.messages.push(e)},l.connect(s)}}}return Messages.$inject=["$injector","$stateParams","platforms"],n(Messages,[{key:"getMessages",value:function(){return this.messages}}]),Messages}();t.default=r},82:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();n(83),n(84);var o=n(85),a=_interopRequireDefault(o),i=n(64),s=_interopRequireDefault(i),l=function(e){function LiveCodingMessageHandler(e,t){_classCallCheck(this,LiveCodingMessageHandler);var n=_possibleConstructorReturn(this,(LiveCodingMessageHandler.__proto__||Object.getPrototypeOf(LiveCodingMessageHandler)).call(this));return n.$http=e,n.$rootScope=t,n.xml2json=a.default.xml2json,n}return LiveCodingMessageHandler.$inject=["$http","$rootScope"],_inherits(LiveCodingMessageHandler,e),r(LiveCodingMessageHandler,[{key:"connect",value:function(e){var t=this,n=new Strophe.Connection("wss://ws.www.livecoding.tv/chat/websocket");n.rawInput=function(n){var r=JSON.parse(t.xml2json(n,{compact:!0}));if(r.message&&t.callback){var o=r.message._attributes.from.replace(e+"@chat.livecoding.tv/",""),a=t.process(r.message.body._text);t.callback({platform:"livecoding",text:o+": "+a}),t.$rootScope.$apply()}},n.connect("public.livecoding.tv",null,function(r){switch(r){case Strophe.Status.CONNECTED:n.muc.join(e+"@chat.livecoding.tv",t.nickname(10))}})}},{key:"process",value:function(e){return e}},{key:"nickname",value:function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++){var o=Math.floor(Math.random()*n.length);t+=n.charAt(o)}return"anonymous"+t}}]),LiveCodingMessageHandler}(s.default);t.default=l},114:function(e,t){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function ChatController(e){_classCallCheck(this,ChatController),this.messages=e.getMessages()};n.$inject=["messages"],t.default=n}});